<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Obsessed Vampires</title>

  <!-- –®—Ä–∏—Ñ—Ç–∏ -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Pirata+One&family=Cormorant+Garamond:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --void: #0f0f0f;
      --void-light: #1a1a1a;
      --blood: #a91b1b;
      --blood-dark: #7a1414;
      --blood-light: #c92929;
      --accent: #b71c1c;
      --bone: #f5f2f0;
      --bone-soft: #e8e4e1;
      --muted: #c4b8b8;
      --muted-dark: #938888;
      --card-bg: #171717;
      --card-hover: #1f1f1f;
      --border-subtle: rgba(139, 20, 20, 0.4);
      --border-hover: rgba(139, 20, 20, 0.7);
      --glow-soft: rgba(169, 27, 27, 0.1);
      --shadow-deep: rgba(0, 0, 0, 0.8);
    }

    *{
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body{
      background: radial-gradient(ellipse at top, #141414 0%, #0a0a0a 50%, #000000 100%);
      color: var(--bone);
      font-family: 'Cormorant Garamond', serif;
      line-height: 1.6;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Skip link –¥–ª—è –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω–æ—ó –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 6px;
      background: var(--blood);
      color: var(--bone);
      padding: 8px;
      text-decoration: none;
      border-radius: 4px;
      z-index: 1000;
      transition: top 0.3s;
    }
    
    .skip-link:focus {
      top: 6px;
    }

    /* –ï–ª–µ–≥–∞–Ω—Ç–Ω–∏–π header */
    header{
      text-align: center;
      padding: 3rem 1rem 2rem;
      border-bottom: 1px solid var(--border-subtle);
      background: linear-gradient(180deg, rgba(20,20,20,0.3) 0%, transparent 100%);
    }

    .header-logo {
      max-width: 100%;
      width: auto;
      height: auto;
      max-height: 200px;
      display: block;
      margin: 0 auto;
      filter: drop-shadow(0 0 30px rgba(169, 27, 27, 0.3)) drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.8));
      transition: all 0.3s ease;
    }

    .header-logo:hover {
      filter: drop-shadow(0 0 40px rgba(169, 27, 27, 0.5)) drop-shadow(2px 2px 8px rgba(0, 0, 0, 0.9));
      transform: scale(1.02);
    }

    header p{
      margin-top: 1.5rem;
      color: var(--muted);
      font-style: bold;
      font-size: 1.1rem;
      font-weight: 300;
      letter-spacing: 1px;
    }

    .wrap{
      max-width: 1200px;
      margin: 3rem auto;
      padding: 0 1.5rem;
    }

    /* –ü–æ–∫—Ä–∞—â–µ–Ω—ñ –∫–æ–Ω—Ç—Ä–æ–ª–∏ */
    .controls{
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      align-items: center;
      margin-bottom: 2.5rem;
    }

    .search-row{
      width: 100%;
      max-width: 600px;
      display: flex;
      justify-content: center;
      position: relative;
    }

    /* –Ü–∫–æ–Ω–∫–∞ –ø–æ—à—É–∫—É */
    .search-row::before {
      content: "üîç";
      position: absolute;
      left: 1.5rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.1rem;
      z-index: 1;
      pointer-events: none;
      opacity: 0.6;
    }

    #searchInput{
      width: 100%;
      padding: 1rem 1.5rem 1rem 3.5rem;
      border-radius: 50px;
      border: 2px solid var(--border-subtle);
      background: rgba(23, 23, 23, 0.9);
      backdrop-filter: blur(10px);
      color: var(--bone);
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.1rem;
      outline: none;
      transition: all 0.3s ease;
      box-shadow: 
        inset 0 2px 10px rgba(0, 0, 0, 0.3),
        0 4px 20px rgba(0, 0, 0, 0.2);
    }

    #searchInput::placeholder{
      color: var(--muted-dark);
      font-style: italic;
      opacity: 0.8;
    }

    #searchInput:focus{
      border-color: var(--border-hover);
      box-shadow: 
        inset 0 2px 10px rgba(0, 0, 0, 0.3),
        0 0 25px var(--glow-soft),
        0 4px 30px rgba(0, 0, 0, 0.4);
      transform: translateY(-2px);
    }

    /* –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ø–æ—à—É–∫—É */
    .clear-search {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 50%;
      transition: all 0.2s ease;
      opacity: 0;
      pointer-events: none;
    }

    .clear-search.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .clear-search:hover {
      color: var(--blood-light);
      background: rgba(169, 27, 27, 0.1);
    }

    .filter-row{
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      gap: 0.8rem;
      justify-items: center;
      width: 100%;
      max-width: 400px;
      border: none;
      outline: none;
    }

    .filter-btn{
      width: 100%;
      min-width: 140px;
      padding: 0.7rem 1.2rem;
      border-radius: 25px;
      border: 2px solid var(--border-subtle);
      background: rgba(23, 23, 23, 0.8);
      backdrop-filter: blur(5px);
      color: var(--bone-soft);
      font-family: 'Cinzel', serif;
      font-size: 0.9rem;
      font-weight: 400;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .filter-btn::before{
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(169, 27, 27, 0.1), transparent);
      transition: left 0.5s;
    }

    .filter-btn:hover, .filter-btn:focus{
      transform: translateY(-3px);
      border-color: var(--border-hover);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
      color: var(--bone);
    }

    .filter-btn:hover::before{
      left: 100%;
    }

    .filter-btn.active{
      background: linear-gradient(135deg, var(--blood-dark), var(--blood));
      border-color: var(--blood-light);
      box-shadow: 
        0 8px 25px rgba(169, 27, 27, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      color: var(--bone);
      transform: translateY(-2px);
    }

    /* –°—Ç–∞—Ç—É—Å - —Ç–µ–ø–µ—Ä —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫ */
    #status{
      width: 200px;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--border-subtle), transparent);
      margin-top: 0.5rem;
      opacity: 0.8;
    }

    /* –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –∫–æ–ª–µ–∫—Ü—ñ—è */
    .collection{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      margin-top: 1.5rem;
    }

    .card{
      background: linear-gradient(145deg, var(--card-bg), var(--void-light));
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 2rem;
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      min-height: 180px;
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      display: flex;
      flex-direction: column;
    }

    .card::before{
      content: '‚ú¶';
      position: absolute;
      top: 1rem;
      right: 1rem;
      color: var(--border-subtle);
      font-size: 1.4rem;
      opacity: 0.6;
      transition: all 0.3s ease;
    }

    .card::after{
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent, rgba(169, 27, 27, 0.02));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .card:hover{
      transform: translateY(-8px) scale(1.02);
      border-color: var(--border-hover);
      background: linear-gradient(145deg, var(--card-hover), #202020);
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.5),
        0 0 30px var(--glow-soft),
        inset 0 1px 0 rgba(255, 255, 255, 0.08);
    }

    .card:hover::before{
      color: var(--border-hover);
      opacity: 1;
      transform: rotate(180deg);
    }

    .card:hover::after{
      opacity: 1;
    }

    .card h2{
      margin: 0 0 1.2rem 0;
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--bone);
      letter-spacing: 1px;
      line-height: 1.3;
      flex-shrink: 0;
    }

    /* –ü–æ–∫—Ä–∞—â–µ–Ω—ñ —Ç–µ–≥–∏ */
    .tags{
      display: flex;
      gap: 0.6rem;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
      flex: 1;
    }

    .tag{
      background: linear-gradient(135deg, rgba(122, 20, 20, 0.8), rgba(169, 27, 27, 0.6));
      border: 2px solid var(--border-subtle);
      color: var(--bone);
      padding: 0.4rem 0.8rem;
      font-size: 0.8rem;
      border-radius: 20px;
      font-family: 'Cinzel', serif;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      height: fit-content;
    }

    .card:hover .tag{
      background: linear-gradient(135deg, var(--blood-dark), var(--blood));
      border-color: var(--border-hover);
      color: var(--bone);
      box-shadow: 0 4px 15px rgba(139, 20, 20, 0.2);
    }

    .card .btn{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.8rem 1.4rem;
      border-radius: 25px;
      border: 2px solid var(--border-subtle);
      background: linear-gradient(135deg, rgba(122, 20, 20, 0.8), rgba(169, 27, 27, 0.6));
      color: var(--bone);
      text-decoration: none;
      font-family: 'Cinzel', serif;
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      margin-top: auto;
      flex-shrink: 0;
    }

    .card .btn::before{
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.6s;
    }

    .card .btn:hover, .card .btn:focus{
      box-shadow: 0 8px 25px rgba(169, 27, 27, 0.3);
      transform: translateY(-2px);
      border-color: var(--blood-light);
      background: linear-gradient(135deg, var(--blood-dark), var(--blood));
    }

    .card .btn:hover::before{
      left: 100%;
    }

    /* –ü–æ–∫—Ä–∞—â–µ–Ω–∏–π –ø–æ—Ä–æ–∂–Ω—ñ–π —Å—Ç–∞–Ω */
    .empty{
      grid-column: 1 / -1;
      padding: 4rem 2rem;
      text-align: center;
      color: var(--muted);
      font-style: italic;
      font-size: 1.2rem;
      font-weight: 300;
      letter-spacing: 0.5px;
      background: linear-gradient(145deg, rgba(23, 23, 23, 0.3), rgba(15, 15, 15, 0.5));
      border-radius: 16px;
      border: 1px solid var(--border-subtle);
      position: relative;
    }

    .empty::before {
      content: "ü¶á";
      font-size: 3rem;
      display: block;
      margin-bottom: 1rem;
      opacity: 0.3;
    }

    /* Loading —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid var(--muted-dark);
      border-radius: 50%;
      border-top-color: var(--blood);
      animation: spin 1s ease-in-out infinite;
      margin-right: 0.5rem;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* –ü–æ–∫—Ä–∞—â–µ–Ω–∏–π –∞–¥–∞–ø—Ç–∏–≤ */
    @media (max-width: 768px){
      header{
        padding: 2rem 1rem 1.5rem;
      }
      
      .header-logo {
        max-height: 150px;
      }
      
      .wrap{
        margin: 2rem auto;
        padding: 0 1rem;
      }
      .filter-row{
        max-width: 320px;
        gap: 0.6rem;
      }
      .filter-btn{
        min-width: 120px;
        padding: 0.6rem 1rem;
        font-size: 0.85rem;
      }
      .collection{
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }
      .card{
        padding: 1.5rem;
      }
    }

    @media (max-width: 480px){
      header{
        padding: 1.5rem 0.5rem 1rem;
      }
      
      .header-logo {
        max-height: 120px;
      }
      
      header p {
        font-size: 1rem;
        margin-top: 1rem;
      }
      
      #searchInput{
        padding: 0.9rem 1.2rem 0.9rem 3.5rem;
        font-size: 1rem;
      }
    }

    @media (max-width: 360px){
      .header-logo {
        max-height: 100px;
      }
      
      header p {
        font-size: 0.9rem;
      }
    }

    /* –î–æ–¥–∞—Ç–∫–æ–≤—ñ –µ—Ñ–µ–∫—Ç–∏ –¥–ª—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∏ */
    @keyframes subtleFloat {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-2px); }
    }

    .card::before {
      animation: subtleFloat 4s ease-in-out infinite;
    }

    /* –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      
      .header-logo:hover {
        transform: none;
      }
    }

    /* –ü—Ä–∏–±–∏—Ä–∞—î–º–æ –∑–∞–π–≤—ñ outline */
    .filter-btn:focus,
    .filter-btn:focus-visible,
    #searchInput:focus,
    #searchInput:focus-visible,
    .card .btn:focus,
    .card .btn:focus-visible,
    button:focus,
    button:focus-visible {
      outline: none !important;
      box-shadow: none !important;
    }

    /* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è */
    .searching .search-row::after {
      content: "";
      position: absolute;
      right: 3.5rem;
      top: 50%;
      transform: translateY(-50%);
      width: 16px;
      height: 16px;
      border: 2px solid var(--muted-dark);
      border-radius: 50%;
      border-top-color: var(--blood);
      animation: spin 1s linear infinite;
    }

    /* –ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ –∫–Ω–æ–ø–∫—É –æ—á–∏—Å—Ç–∫–∏ —Ç—ñ–ª—å–∫–∏ –∫–æ–ª–∏ —î —Ç–µ–∫—Å—Ç */
    .has-text .clear-search {
      opacity: 1;
      pointer-events: auto;
    }

    /* –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è —â–æ –∫–Ω–æ–ø–∫–∏ –º–æ–∂–Ω–∞ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ */
    .card .btn {
      pointer-events: auto !important;
      z-index: 10 !important;
      position: relative !important;
    }

    /* –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è —â–æ –ø—Å–µ–≤–¥–æ–µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–µ –±–ª–æ–∫—É—é—Ç—å –∫–ª—ñ–∫–∏ */
    .card .btn::before,
    .card .btn::after {
      pointer-events: none !important;
    }

    /* –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è —â–æ –∫–∞—Ä—Ç–∫–∏ –Ω–µ –±–ª–æ–∫—É—é—Ç—å –∫–ª—ñ–∫–∏ */
    .card::before,
    .card::after {
      pointer-events: none !important;
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É</a>
  
  <header>
    <img src="https://i.ibb.co/kV9Skfd2/IMG-20250911-151703-461.png" alt="Obsessed Vampires" class="header-logo" />
    <p>‚ú¶ Eternal Darkness Collection ‚ú¶</p>
  </header>

  <main class="wrap" id="main-content">
    <!-- –ü–æ—à—É–∫ + —Ñ—ñ–ª—å—Ç—Ä–∏ -->
    <div class="controls">
      <div class="search-row">
        <input 
          id="searchInput" 
          type="text" 
          placeholder="–®—É–∫–∞—Ç–∏ —É —Ç–µ–º—Ä—è–≤—ñ..." 
          aria-label="–ü–æ—à—É–∫ –ø–æ –∫–æ–ª–µ–∫—Ü—ñ—ó"
          autocomplete="off"
        />
        <button class="clear-search" type="button" aria-label="–û—á–∏—Å—Ç–∏—Ç–∏ –ø–æ—à—É–∫" title="–û—á–∏—Å—Ç–∏—Ç–∏ –ø–æ—à—É–∫">‚úï</button>
      </div>

      <div class="filter-row">
        <button class="filter-btn" type="button" data-filter="–∞–Ω—ñ–º–æ–≤–∞–Ω—ñ">–ê–Ω—ñ–º–æ–≤–∞–Ω—ñ</button>
        <button class="filter-btn" type="button" data-filter="—Å—Ç–∞—Ç–∏—á–Ω—ñ">–°—Ç–∞—Ç–∏—á–Ω—ñ</button>
        <button class="filter-btn" type="button" data-filter="–µ–º–æ–¥–∂—ñ">–ï–º–æ–¥–∂—ñ</button>
        <button class="filter-btn" type="button" data-filter="–∞–≤–∞—Ç–∞—Ä–∫–∏">–ê–≤–∞—Ç–∞—Ä–∫–∏</button>
      </div>

      <div id="status"></div>
    </div>

    <!-- –ö–æ–ª–µ–∫—Ü—ñ—è –∫–∞—Ä—Ç–æ–∫ -->
    <section class="collection" id="cards" role="region" aria-label="–ö–æ–ª–µ–∫—Ü—ñ—è –∑–æ–±—Ä–∞–∂–µ–Ω—å">
      <!-- –ö–∞—Ä—Ç–∫–∏ –±—É–¥—É—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –∑ Google Sheets -->
    </section>
  </main>

  <script>
    // --- Google Sheets API ---
    const SHEET_ID = '16FR9S-8fO4VaiHiY6yEWWmnhB9_NjB48HSYJD58vKrs';
    const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –ø–æ—Å–∏–ª–∞–Ω—å
    function processLink(link) {
      if (!link || link === '#' || link.trim() === '') {
        console.log('–ü–æ—Ä–æ–∂–Ω—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è, –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ #');
        return '#';
      }

      const cleanLink = link.trim();
      console.log('–û–±—Ä–æ–±–ª—è—î–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:', cleanLink);
      
      // –Ø–∫—â–æ —Ü–µ –≤–∂–µ –≥–æ—Ç–æ–≤–µ HTTP/HTTPS –ø–æ—Å–∏–ª–∞–Ω–Ω—è - –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ —è–∫ —î
      if (cleanLink.startsWith('http://') || cleanLink.startsWith('https://')) {
        console.log('–ì–æ—Ç–æ–≤–µ HTTP –ø–æ—Å–∏–ª–∞–Ω–Ω—è:', cleanLink);
        return cleanLink;
      }
      
      // –Ø–∫—â–æ —Ü–µ Telegram –ø–æ—Å–∏–ª–∞–Ω–Ω—è –±–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª—É
      if (cleanLink.startsWith('t.me/')) {
        const fullLink = `https://${cleanLink}`;
        console.log('Telegram –ø–æ—Å–∏–ª–∞–Ω–Ω—è –±–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª—É, –¥–æ–¥–∞—î–º–æ https:', fullLink);
        return fullLink;
      }
      
      // –Ø–∫—â–æ —Ü–µ ID —Ñ–∞–π–ª—É Google Drive (—Ç—ñ–ª—å–∫–∏ —Å–∏–º–≤–æ–ª–∏ a-z, A-Z, 0-9, _, -)
      const driveIdPattern = /^[a-zA-Z0-9_-]+$/;
      if (driveIdPattern.test(cleanLink) && cleanLink.length > 20) {
        const fullLink = `https://drive.google.com/file/d/${cleanLink}/view`;
        console.log('Google Drive ID, —Å—Ç–≤–æ—Ä—é—î–º–æ –ø–æ–≤–Ω–∏–π URL:', fullLink);
        return fullLink;
      }
      
      // –Ø–∫—â–æ —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ URL Google Drive
      if (cleanLink.includes('drive.google.com') || cleanLink.includes('docs.google.com')) {
        // –í–∏—Ç—è–≥—É—î–º–æ ID –∑ —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ç—ñ–≤ Google Drive URLs
        const patterns = [
          /\/d\/([a-zA-Z0-9_-]+)/,
          /id=([a-zA-Z0-9_-]+)/,
          /file\/d\/([a-zA-Z0-9_-]+)/
        ];
        
        for (let pattern of patterns) {
          const match = cleanLink.match(pattern);
          if (match) {
            const fullLink = `https://drive.google.com/file/d/${match[1]}/view`;
            console.log('–í–∏—Ç—è–≥–Ω—É—Ç–æ Google Drive ID, —Å—Ç–≤–æ—Ä–µ–Ω–æ URL:', fullLink);
            return fullLink;
          }
        }
      }
      
      // –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ —Ç–∏–ø, –∞–ª–µ —Å—Ö–æ–∂–µ –Ω–∞ URL –±–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª—É
      if (cleanLink.includes('.') && !cleanLink.includes(' ')) {
        const fullLink = `https://${cleanLink}`;
        console.log('–î–æ–¥–∞—î–º–æ https –¥–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:', fullLink);
        return fullLink;
      }
      
      console.log('–ù–µ –≤–¥–∞–ª–æ—Å—è –æ–±—Ä–æ–±–∏—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è, –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ —è–∫ —î:', cleanLink);
      return cleanLink;
    }

    async function loadDataFromSheets() {
      try {
        console.log('–†–æ–±–∏–º–æ –∑–∞–ø–∏—Ç –¥–æ Google Sheets...');
        const response = await fetch(SHEET_URL);
        console.log('–í—ñ–¥–ø–æ–≤—ñ–¥—å –æ—Ç—Ä–∏–º–∞–Ω–æ:', response.status);
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const text = await response.text();
        console.log('–¢–µ–∫—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–ø–µ—Ä—à—ñ 200 —Å–∏–º–≤–æ–ª—ñ–≤):', text.substring(0, 200));
        
        // –í–∏–¥–∞–ª—è—î–º–æ –æ–±–≥–æ—Ä—Ç–∫—É Google Sheets
        const jsonString = text.substring(47).slice(0, -2);
        const data = JSON.parse(jsonString);
        console.log('–ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–∏—Ö —É—Å–ø—ñ—à–Ω–∏–π');
        
        const processedData = data.table.rows.slice(1) // –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏
          .filter(row => row.c && row.c[0] && row.c[0].v) // —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ –ø–æ—Ä–æ–∂–Ω—ñ —Ä—è–¥–∫–∏
          .map(row => {
            const rawLink = row.c[2]?.v || '#';
            const processedLink = processLink(rawLink);
            
            console.log('–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:', rawLink);
            console.log('–û–±—Ä–æ–±–ª–µ–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:', processedLink);
            
            return {
              title: row.c[0]?.v || '',
              keywords: row.c[1]?.v || '',
              link: processedLink,
              tags: row.c[3]?.v || ''
            };
          });
          
        console.log('–û–±—Ä–æ–±–ª–µ–Ω—ñ –¥–∞–Ω—ñ:', processedData);
        return processedData;
      } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ Google Sheets:', error);
        return [];
      }
    }

    function createCard(item) {
      const tagsArray = item.tags.split('/').filter(tag => tag.trim());
      const tagsHTML = tagsArray.map(tag => `<span class="tag">${tag.trim()}</span>`).join('');
      
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥—ñ–π—Å–Ω–µ
      const isValidLink = item.link && item.link !== '#' && item.link.trim() !== '';
      
      console.log('–°—Ç–≤–æ—Ä—é—î–º–æ –∫–∞—Ä—Ç–∫—É:', item.title, '–∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º:', item.link, '–¥—ñ–π—Å–Ω–µ:', isValidLink, '–∑ —Ç–µ–≥–∞–º–∏:', tagsArray);
      
      return `
        <article class="card" data-tags="${item.tags.toLowerCase()}" data-keywords="${item.keywords.toLowerCase()}">
          <h2>${item.title}</h2>
          <div class="tags">
            ${tagsHTML}
          </div>
          <a class="btn" href="${item.link}" data-link="${item.link}" target="_blank" rel="noopener">–í—ñ–¥–∫—Ä–∏—Ç–∏</a>
        </article>
      `;
    }

    // –§—É–Ω–∫—Ü—ñ—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
    function diagnoseButtons() {
      const allButtons = document.querySelectorAll('.card .btn');
      console.log('–í—Å—å–æ–≥–æ –∫–Ω–æ–ø–æ–∫ –∑–Ω–∞–π–¥–µ–Ω–æ:', allButtons.length);
      
      allButtons.forEach((btn, i) => {
        const card = btn.closest('.card');
        const isVisible = card && window.getComputedStyle(card).display !== 'none';
        const hasEvents = btn.onclick || btn.addEventListener;
        console.log(`–ö–Ω–æ–ø–∫–∞ ${i}: –≤–∏–¥–∏–º–∞=${isVisible}, –º–∞—î –æ–±—Ä–æ–±–Ω–∏–∫–∏=${!!hasEvents}, –ø–æ—Å–∏–ª–∞–Ω–Ω—è=${btn.href}`);
      });
    }

    // –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π –ø—ñ–¥—Ö—ñ–¥ - –ø—Ä—è–º–µ –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ
    function setupEventDelegation() {
      const cardsContainer = document.getElementById('cards');
      
      // –í–∏–¥–∞–ª—è—î–º–æ —Å—Ç–∞—Ä–∏–π –æ–±—Ä–æ–±–Ω–∏–∫ —è–∫—â–æ —î
      cardsContainer.removeEventListener('click', cardClickHandler);
      
      // –î–æ–¥–∞—î–º–æ –Ω–æ–≤–∏–π –æ–±—Ä–æ–±–Ω–∏–∫
      cardsContainer.addEventListener('click', cardClickHandler);
      console.log('–î–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ –∫–∞—Ä—Ç–æ–∫');
    }

    function cardClickHandler(event) {
      console.log('–ë—É–¥—å-—è–∫–∏–π –∫–ª—ñ–∫ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ –∫–∞—Ä—Ç–æ–∫:', event.target);
      console.log('–ö–ª—ñ–∫–Ω—É—Ç–∏–π –µ–ª–µ–º–µ–Ω—Ç:', event.target.tagName, event.target.className);
      
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∫–ª—ñ–∫ –±—É–≤ –ø–æ –∫–Ω–æ–ø—Ü—ñ –∞–±–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–Ω–æ–ø–∫–∏
      let button = null;
      if (event.target.classList.contains('btn')) {
        button = event.target;
      } else if (event.target.closest('.btn')) {
        button = event.target.closest('.btn');
      }
      
      if (button) {
        console.log('üî¥ –ö–õ–Ü–ö –ü–û –ö–ù–û–ü–¶–Ü –í–ò–Ø–í–õ–ï–ù–û!');
        const link = button.getAttribute('data-link') || button.getAttribute('href');
        
        console.log('–ü–æ—Å–∏–ª–∞–Ω–Ω—è:', link);
        console.log('–ö–Ω–æ–ø–∫–∞:', button);
        
        event.preventDefault();
        event.stopPropagation();
        
        // –ü–æ–∫–∞–∑—É—î–º–æ alert —â–æ–± —Ç–æ—á–Ω–æ –ø–æ–±–∞—á–∏—Ç–∏ —â–æ –∫–ª—ñ–∫ —Å–ø—Ä–∞—Ü—é–≤–∞–≤
        alert(`–ö–õ–Ü–ö –°–ü–†–ê–¶–Æ–í–ê–í!\n–ü–æ—Å–∏–ª–∞–Ω–Ω—è: ${link}`);
        
        if (!link || link === '#' || link.trim() === '') {
          console.log('–ù–µ–¥—ñ–π—Å–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è!');
          return false;
        }
        
        try {
          console.log('–í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:', link);
          
          if (link.includes('t.me')) {
            // –î–ª—è Telegram - –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î–º–æ
            window.location.href = link;
          } else {
            // –î–ª—è —ñ–Ω—à–∏—Ö –ø–æ—Å–∏–ª–∞–Ω—å
            const newWindow = window.open(link, '_blank', 'noopener,noreferrer');
            if (!newWindow) {
              window.location.href = link;
            }
          }
          
        } catch (error) {
          console.error('–ü–æ–º–∏–ª–∫–∞:', error);
          alert('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è: ' + error.message);
        }
        
        return false;
      } else {
        console.log('–ö–ª—ñ–∫ –ù–ï –ø–æ –∫–Ω–æ–ø—Ü—ñ');
      }
    }

    // –°–ø—Ä–æ—â–µ–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ (–∑–∞–ª–∏—à–∞—î–º–æ —è–∫ –∑–∞–ø–∞—Å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç)
    function addClickHandlers() {
      console.log('addClickHandlers –≤–∏–∫–ª–∏–∫–∞–Ω–æ');
      diagnoseButtons();
      setupEventDelegation();
    }

    // –î–æ–¥–∞—î–º–æ —Ç–µ—Å—Ç–æ–≤—É –∫–Ω–æ–ø–∫—É –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
    function addTestButton() {
      const testBtn = document.createElement('button');
      testBtn.textContent = '–¢–ï–°–¢ –ö–ù–û–ü–ö–ê';
      testBtn.style.cssText = 'position:fixed;top:10px;right:10px;z-index:9999;background:red;color:white;padding:10px;border:none;border-radius:5px;';
      testBtn.addEventListener('click', function() {
        console.log('üü¢ –¢–ï–°–¢ –ö–ù–û–ü–ö–ê –ü–†–ê–¶–Æ–Ñ!');
        alert('–¢–µ—Å—Ç –∫–Ω–æ–ø–∫–∞ –ø—Ä–∞—Ü—é—î!');
      });
      document.body.appendChild(testBtn);
    }

    // --- –õ–æ–≥—ñ–∫–∞ –ø–æ—à—É–∫—É —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ ---
    (function(){
      const searchInput = document.getElementById('searchInput');
      const clearBtn = document.querySelector('.clear-search');
      const filterBtns = Array.from(document.querySelectorAll('.filter-btn'));
      const cardsContainer = document.getElementById('cards');
      const status = document.getElementById('status');
      const controls = document.querySelector('.controls');
      let activeFilter = '';
      let allCards = [];

      // —É—Ç–∏–ª—ñ—Ç–∞ debounce
      function debounce(fn, ms=300){
        let t;
        return (...args)=>{ 
          clearTimeout(t); 
          t = setTimeout(()=>fn(...args), ms); 
        };
      }

      function normalize(s){
        return (s||'').toString().trim().toLowerCase();
      }

      function updateClearButton() {
        const hasText = searchInput.value.trim().length > 0;
        clearBtn.classList.toggle('visible', hasText);
        document.body.classList.toggle('has-text', hasText);
      }

      function showSearching() {
        // –ù—ñ—á–æ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—É—î–º–æ –ø—ñ–¥ —á–∞—Å –ø–æ—à—É–∫—É
      }

      function hideSearching() {
        // –ù—ñ—á–æ–≥–æ –Ω–µ –ø—Ä–∏—Ö–æ–≤—É—î–º–æ
      }

      function filterCards(){
        const q = normalize(searchInput.value);
        let visibleCount = 0;

        allCards.forEach(card=>{
          const title = normalize(card.querySelector('h2')?.textContent);
          const tagsRaw = normalize(card.dataset.tags || '');
          const keywordsRaw = normalize(card.dataset.keywords || '');
          
          // –ü–∞—Ä—Å–∏–º–æ —Ç–µ–≥–∏ - –≤–æ–Ω–∏ —Ä–æ–∑–¥—ñ–ª–µ–Ω—ñ —á–µ—Ä–µ–∑ "/"
          const tagsArr = tagsRaw.split('/').map(s=>s.trim()).filter(Boolean);
          const keywordsArr = keywordsRaw.split(',').map(s=>s.trim()).filter(Boolean);

          console.log('–ö–∞—Ä—Ç–∫–∞:', title, '–¢–µ–≥–∏:', tagsArr, '–ê–∫—Ç–∏–≤–Ω–∏–π —Ñ—ñ–ª—å—Ç—Ä:', activeFilter);

          const matchesQuery = !q || 
            title.includes(q) || 
            tagsArr.some(t => t.includes(q)) ||
            keywordsArr.some(k => k.includes(q));
            
          const matchesFilter = !activeFilter || tagsArr.some(t => t === activeFilter);

          const show = matchesQuery && matchesFilter;
          card.style.display = show ? '' : 'none';
          if(show) visibleCount++;
        });

        // –°—Ç–∞—Ç—É—Å
        const existingEmpty = document.querySelector('.empty');
        
        if(visibleCount === 0){
          if(!existingEmpty){
            const el = document.createElement('div');
            el.className = 'empty';
            el.innerHTML = '–ü–æ—Ä–æ–∂–Ω–µ—á–∞. –ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ —É –±–µ–∑–æ–¥–Ω—ñ.';
            cardsContainer.appendChild(el);
          }
        } else {
          if(existingEmpty) existingEmpty.remove();
        }
        
        // –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è, —â–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –∫–ª—ñ–∫—ñ–≤ –¥–æ–¥–∞–Ω—ñ –ø—ñ—Å–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó
        addClickHandlers();
        
        hideSearching();
      }

      const debouncedFilter = debounce(filterCards, 250);

      searchInput.addEventListener('input', ()=> {
        updateClearButton();
        debouncedFilter();
      });

      clearBtn.addEventListener('click', () => {
        searchInput.value = '';
        searchInput.focus();
        updateClearButton();
        filterCards();
      });

      filterBtns.forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const val = normalize(btn.dataset.filter);
          if(activeFilter === val){
            activeFilter = '';
            btn.classList.remove('active');
            btn.setAttribute('aria-pressed', 'false');
          } else {
            activeFilter = val;
            filterBtns.forEach(b => {
              const isActive = normalize(b.dataset.filter) === val;
              b.classList.toggle('active', isActive);
              b.setAttribute('aria-pressed', isActive.toString());
            });
          }
          filterCards();
        });

        btn.setAttribute('aria-pressed', 'false');
      });

      searchInput.addEventListener('keydown', (e)=>{
        if(e.key === 'Escape') { 
          searchInput.value=''; 
          updateClearButton();
          filterCards(); 
        }
      });

      // –ü–æ–ª—ñ–ø—à–µ–Ω–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–æ—é
      document.addEventListener('keydown', (e) => {
        if (e.key === '/' && e.target !== searchInput) {
          e.preventDefault();
          searchInput.focus();
        }
      });

      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
      updateClearButton();

      // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ Google Sheets
      async function init() {
        try {
          console.log('–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...');
          const data = await loadDataFromSheets();
          console.log('–û—Ç—Ä–∏–º–∞–Ω—ñ –¥–∞–Ω—ñ:', data);
          
          if (data.length === 0) {
            cardsContainer.innerHTML = '<div class="empty">–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è</div>';
            return;
          }
          
          const cardsHTML = data.map(createCard).join('');
          cardsContainer.innerHTML = cardsHTML;
          allCards = Array.from(cardsContainer.querySelectorAll('.card'));
          console.log('–°—Ç–≤–æ—Ä–µ–Ω–æ –∫–∞—Ä—Ç–æ–∫:', allCards.length);
          
          // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –∫–ª—ñ–∫—ñ–≤ –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–∞—Ä—Ç–æ–∫
          addClickHandlers();
          
          // –î–æ–¥–∞—î–º–æ —Ç–µ—Å—Ç–æ–≤—É –∫–Ω–æ–ø–∫—É –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
          addTestButton();
          
          filterCards();
        } catch (error) {
          console.error('–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó:', error);
          cardsContainer.innerHTML = '<div class="empty">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</div>';
        }
      }

      init();
    })();
  </script>
</body>
</html>
